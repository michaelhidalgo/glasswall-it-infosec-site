(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{101:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return u}));var r=n(3),a=n(8),o=(n(0),n(136)),i={title:"Dynamic Code Execution",sidebar_label:"Dynamic Code Execution"},c={unversionedId:"security_awareness/languages/Python/DynamicCodeExecution",id:"security_awareness/languages/Python/DynamicCodeExecution",isDocsHomePage:!1,title:"Dynamic Code Execution",description:"Description",source:"@site/docs/security_awareness/languages/Python/DynamicCodeExecution.md",slug:"/security_awareness/languages/Python/DynamicCodeExecution",permalink:"/docs/security_awareness/languages/Python/DynamicCodeExecution",version:"current",sidebar_label:"Dynamic Code Execution",sidebar:"someSidebar",previous:{title:"Injection Attacks",permalink:"/docs/security_awareness/languages/Python/InjectionAttacks"},next:{title:"Request Redirect",permalink:"/docs/security_awareness/languages/Python/RequestRedirect"}},s=[{value:"Description",id:"description",children:[]},{value:"Vulnerable Code Example",id:"vulnerable-code-example",children:[]},{value:"Mitigation",id:"mitigation",children:[]},{value:"Risk Assessment",id:"risk-assessment",children:[]},{value:"References",id:"references",children:[]}],l={toc:s};function u(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"description"},"Description"),Object(o.b)("p",null,"Dynamic code execution should not be vulnerable to injection attacks. Applications that execute code dynamically should neutralize any externally-provided values used to construct the code. Failure to do so could allow an attacker to execute arbitrary code. This could enable a wide range of serious attacks like accessing/modifying sensitive information or gain full system access."),Object(o.b)("p",null,"The mitigation strategy should be based on whitelisting of allowed values or casting to safe types."),Object(o.b)("h2",{id:"vulnerable-code-example"},"Vulnerable Code Example"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},'from flask import request\n\n@app.route(\'/\')\ndef index():\n    module = request.args.get("module")\n    exec("import urllib%s as urllib" % module) # N\n')),Object(o.b)("h2",{id:"mitigation"},"Mitigation"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},'from flask import request\n\n@app.route(\'/\')\ndef index():\n    module = request.args.get("module")\n    exec("import urllib%d as urllib" % int(module)) # Compliant; module is safely cast to an integer\n')),Object(o.b)("h2",{id:"risk-assessment"},"Risk Assessment"),Object(o.b)("p",null,"Injection can result in data loss, corruption, or disclosure to unauthorized parties, loss of accountability, or denial of access. Injection can sometimes lead to complete host takeover.\nThe business impact depends on the needs of the application and data."),Object(o.b)("h2",{id:"references"},"References"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",{parentName:"li",href:"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection.html"},"A1:2017-Injection")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",{parentName:"li",href:"https://cwe.mitre.org/data/definitions/94.html"},"CWE-94: Improper Control of Generation of Code ('Code Injection')")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",{parentName:"li",href:"https://cwe.mitre.org/data/definitions/95.html"},"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"))))}u.isMDXComponent=!0},136:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=a.a.createContext({}),u=function(e){var t=a.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},d=function(e){var t=u(e.components);return a.a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},m=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=u(n),m=r,b=d["".concat(i,".").concat(m)]||d[m]||p[m]||o;return n?a.a.createElement(b,c(c({ref:t},l),{},{components:n})):a.a.createElement(b,c({ref:t},l))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,i[1]=c;for(var l=2;l<o;l++)i[l]=n[l];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);