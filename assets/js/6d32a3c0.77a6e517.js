(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{136:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var r=n(0),a=n.n(r);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=a.a.createContext({}),p=function(e){var t=a.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},u=function(e){var t=p(e.components);return a.a.createElement(l.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},y=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=p(n),y=r,m=u["".concat(o,".").concat(y)]||u[y]||b[y]||i;return n?a.a.createElement(m,c(c({ref:t},l),{},{components:n})):a.a.createElement(m,c({ref:t},l))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=y;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,o[1]=c;for(var l=2;l<i;l++)o[l]=n[l];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,n)}y.displayName="MDXCreateElement"},97:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return p}));var r=n(3),a=n(8),i=(n(0),n(136)),o={title:"Weak Encryption",sidebar_label:"Weak Encryption"},c={unversionedId:"security_awareness/languages/Python/WeakEncryption",id:"security_awareness/languages/Python/WeakEncryption",isDocsHomePage:!1,title:"Weak Encryption",description:"Description",source:"@site/docs/security_awareness/languages/Python/WeakEncryption.md",slug:"/security_awareness/languages/Python/WeakEncryption",permalink:"/docs/security_awareness/languages/Python/WeakEncryption",version:"current",sidebar_label:"Weak Encryption",sidebar:"someSidebar",previous:{title:"Deserialization",permalink:"/docs/security_awareness/languages/Python/Deserialization"},next:{title:"XML External Entities (XXE)",permalink:"/docs/security_awareness/languages/Python/XXE"}},s=[{value:"Description",id:"description",children:[]},{value:"Vulnerable Code Example",id:"vulnerable-code-example",children:[]},{value:"Mitigation",id:"mitigation",children:[]},{value:"Risk Assessment",id:"risk-assessment",children:[]},{value:"References",id:"references",children:[]}],l={toc:s};function p(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"description"},"Description"),Object(i.b)("p",null,"When generating cryptographic keys (or key pairs), it is important to use strong parameters. Key length, for instance, should provides enough entropy against brute-force attacks."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"For RSA and DSA algorithms key size should be at least 2048 bits long"),Object(i.b)("li",{parentName:"ul"},"For ECC (elliptic curve cryptography) algorithms key size should be at least 224 bits long"),Object(i.b)("li",{parentName:"ul"},"For RSA public key exponent should be at least 65537.")),Object(i.b)("p",null,"This rule raises an issue when an RSA, DSA or ECC key-pair generator is initialized using weak parameters."),Object(i.b)("p",null,"It supports the following libraries:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"cryptography"),Object(i.b)("li",{parentName:"ul"},"PyCrypto"),Object(i.b)("li",{parentName:"ul"},"Cryptodome")),Object(i.b)("h2",{id:"vulnerable-code-example"},"Vulnerable Code Example"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-python"},"from cryptography.hazmat.primitives.asymmetric import rsa, ec, dsa\n\ndsa.generate_private_key(key_size=1024, backend=backend) # Noncompliant\nrsa.generate_private_key(public_exponent=999, key_size=2048, backend=backend) # Noncompliant\nec.generate_private_key(curve=ec.SECT163R2, backend=backend)  # Noncompliant\n")),Object(i.b)("h2",{id:"mitigation"},"Mitigation"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-python"},"from cryptography.hazmat.primitives.asymmetric import rsa, ec, dsa\n\ndsa.generate_private_key(key_size=2048, backend=backend) # Compliant\nrsa.generate_private_key(public_exponent=65537, key_size=2048, backend=backend) # Compliant\nec.generate_private_key(curve=ec.SECT409R1, backend=backend) # Compliant\n")),Object(i.b)("h2",{id:"risk-assessment"},"Risk Assessment"),Object(i.b)("p",null,"An attacker may be able to decrypt the data using brute force attacks. Such flaws frequently give attackers unauthorized access to some system data or functionality. Occasionally, such flaws result in a complete system compromise."),Object(i.b)("h2",{id:"references"},"References"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://cwe.mitre.org/data/definitions/326.html"},"CWE-326: Inadequate Encryption Strength")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html"},"A3:2017-Sensitive Data Exposure")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html"},"A6:2017-Security Misconfiguration")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf"},"NIST FIPS 186-4 - Digital Signature Standard (DSS)"))))}p.isMDXComponent=!0}}]);