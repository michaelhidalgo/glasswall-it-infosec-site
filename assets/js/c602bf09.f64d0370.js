(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{116:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return s})),t.d(n,"metadata",(function(){return o})),t.d(n,"toc",(function(){return c})),t.d(n,"default",(function(){return u}));var r=t(3),i=t(8),a=(t(0),t(136)),s={title:"Cross-origin Communications Vulnerability",sidebar_label:"Cross-origin Communications Vulnerability"},o={unversionedId:"security_awareness/languages/TypeScript/CrossOrigin",id:"security_awareness/languages/TypeScript/CrossOrigin",isDocsHomePage:!1,title:"Cross-origin Communications Vulnerability",description:"Description",source:"@site/docs/security_awareness/languages/TypeScript/CrossOrigin.md",slug:"/security_awareness/languages/TypeScript/CrossOrigin",permalink:"/docs/security_awareness/languages/TypeScript/CrossOrigin",version:"current",sidebar_label:"Cross-origin Communications Vulnerability",sidebar:"someSidebar",previous:{title:"Cross-Site Request Forgery (CSRF)",permalink:"/docs/security_awareness/languages/TypeScript/CSRF"},next:{title:"JWT Sensitive Data Exposure",permalink:"/docs/security_awareness/languages/TypeScript/JWTSensitiveDataExposure"}},c=[{value:"Description",id:"description",children:[]},{value:"Vulnerabilities",id:"vulnerabilities",children:[{value:"Mitigation",id:"mitigation",children:[]}]},{value:"Risk Assessment",id:"risk-assessment",children:[]},{value:"References",id:"references",children:[]}],l={toc:c};function u(e){var n=e.components,t=Object(i.a)(e,["components"]);return Object(a.b)("wrapper",Object(r.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"description"},"Description"),Object(a.b)("p",null,"Browsers allow message exchanges between Window objects of different origins."),Object(a.b)("p",null,"Because any window can send / receive messages from other window it is important to verify the sender's / receiver's identity:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"When sending message with postMessage method, the identity's receiver should be defined (the wildcard keyword (*) should not be used)."),Object(a.b)("li",{parentName:"ul"},"When receiving message with message event, the sender's identity should be verified using the origin and possibly source properties.")),Object(a.b)("h2",{id:"vulnerabilities"},"Vulnerabilities"),Object(a.b)("p",null,"When sending message:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-javascript"},'var iframe = document.getElementById("testiframe");\niframe.contentWindow.postMessage("secret", "*"); // Noncompliant: * is used\n}\n')),Object(a.b)("p",null,"When receiving message:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-javascript"},'window.addEventListener("message", function(event) { // Noncompliant: no checks are done on the origin property.\n      console.log(event.data);\n });\n')),Object(a.b)("h3",{id:"mitigation"},"Mitigation"),Object(a.b)("p",null,"When sending message:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-javascript"},'var iframe = document.getElementById("testsecureiframe");\niframe.contentWindow.postMessage("hello", "https://secure.example.com"); // Compliant\n}\n')),Object(a.b)("p",null,"When receiving message:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-javascript"},'window.addEventListener("message", function(event) {\n\n  if (event.origin !== "http://example.org") // Compliant\n    return;\n\n  console.log(event.data)\n});\n')),Object(a.b)("h2",{id:"risk-assessment"},"Risk Assessment"),Object(a.b)("p",null,"Attackers have to gain access to only a few accounts, or just one admin account to compromise the system. Depending on the domain of the application, this may allow money laundering, social security fraud, and identity theft, or disclose legally protected highly sensitive information."),Object(a.b)("h2",{id:"references"},"References"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",{parentName:"li",href:"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication"},"OWASP Top 10 2017 Category A3 - Broken Authentication and Session Management")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage"},"Developer.mozilla.org - postMessage API"))))}u.isMDXComponent=!0},136:function(e,n,t){"use strict";t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return m}));var r=t(0),i=t.n(r);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=i.a.createContext({}),u=function(e){var n=i.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=u(e.components);return i.a.createElement(l.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return i.a.createElement(i.a.Fragment,{},n)}},b=i.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=u(t),b=r,m=p["".concat(s,".").concat(b)]||p[b]||d[b]||a;return t?i.a.createElement(m,o(o({ref:n},l),{},{components:t})):i.a.createElement(m,o({ref:n},l))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,s=new Array(a);s[0]=b;var o={};for(var c in n)hasOwnProperty.call(n,c)&&(o[c]=n[c]);o.originalType=e,o.mdxType="string"==typeof e?e:r,s[1]=o;for(var l=2;l<a;l++)s[l]=t[l];return i.a.createElement.apply(null,s)}return i.a.createElement.apply(null,t)}b.displayName="MDXCreateElement"}}]);