(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{108:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return p}));var r=n(3),a=n(8),i=(n(0),n(136)),o={title:"Improper Certificate Validation",sidebar_label:"Improper Certificate Validation"},c={unversionedId:"security_awareness/languages/TypeScript/ImproperCertificateValidation",id:"security_awareness/languages/TypeScript/ImproperCertificateValidation",isDocsHomePage:!1,title:"Improper Certificate Validation",description:"Description",source:"@site/docs/security_awareness/languages/TypeScript/ImproperCertificateValidation.md",slug:"/security_awareness/languages/TypeScript/ImproperCertificateValidation",permalink:"/docs/security_awareness/languages/TypeScript/ImproperCertificateValidation",version:"current",sidebar_label:"Improper Certificate Validation",sidebar:"someSidebar",previous:{title:"Broken Authentication",permalink:"/docs/security_awareness/languages/TypeScript/BrokenAuthentication"},next:{title:"Cross-Site Request Forgery (CSRF)",permalink:"/docs/security_awareness/languages/TypeScript/CSRF"}},s=[{value:"Description",id:"description",children:[]},{value:"Vulnerable Code Example",id:"vulnerable-code-example",children:[]},{value:"Mitigation",id:"mitigation",children:[]},{value:"Risk Assessment",id:"risk-assessment",children:[]},{value:"References",id:"references",children:[]}],l={toc:s};function p(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"description"},"Description"),Object(i.b)("p",null,"Validation of X.509 certificates is essential to create secure SSL/TLS sessions not vulnerable to man-in-the-middle attacks."),Object(i.b)("p",null,"The certificate chain validation includes these steps:"),Object(i.b)("p",null,"The certificate is issued by its parent Certificate Authority or the root CA trusted by the system."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Each CA is allowed to issue certificates."),Object(i.b)("li",{parentName:"ul"},"Each certificate in the chain is not expired."),Object(i.b)("li",{parentName:"ul"},"It's not recommended to reinvent the wheel by implementing custom certificate chain validation.")),Object(i.b)("p",null,"TLS libraries provide built-in certificate validation functions that should be used."),Object(i.b)("h2",{id:"vulnerable-code-example"},"Vulnerable Code Example"),Object(i.b)("p",null,"There is no way to disable certificate verification in tls, https and request modules but it is possible to not reject request when verification fails."),Object(i.b)("p",null,"https built-in module:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-javascript"},"let options = {\n  hostname: 'www.example.com',\n  port: 443,\n  path: '/',\n  method: 'GET',\n  secureProtocol: 'TLSv1_2_method',\n  rejectUnauthorized: false ; // Noncompliant\n};\n\nlet req = https.request(options, (res) => {\n  res.on('data', (d) => {\n    process.stdout.write(d);\n  });\n}); // Noncompliant\n")),Object(i.b)("p",null,"tls built-in module:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-javascript"},"let options = {\n    secureProtocol: 'TLSv1_2_method',\n    rejectUnauthorized: false ; // Noncompliant\n};\n\nlet socket = tls.connect(443, \"www.example.com\", options, () => {\n  process.stdin.pipe(socket);\n  process.stdin.resume();\n});  // Noncompliant\n")),Object(i.b)("p",null,"request module:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-javascript"},"let socket = request.get({\n    url: 'www.example.com',\n    secureProtocol: 'TLSv1_2_method',\n    rejectUnauthorized: false ; // Noncompliant\n});\n")),Object(i.b)("h2",{id:"mitigation"},"Mitigation"),Object(i.b)("p",null,"https built-in module:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-javascript"},"let options = {\n  hostname: 'www.example.com',\n  port: 443,\n  path: '/',\n  method: 'GET',\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet req = https.request(options, (res) => {\n  res.on('data', (d) => {\n    process.stdout.write(d);\n  });\n}); // Compliant: by default rejectUnauthorized  is set to true\n")),Object(i.b)("p",null,"tls built-in module:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-javascript"},"let options = {\n    secureProtocol: 'TLSv1_2_method'\n};\n\nlet socket = tls.connect(443, \"www.example.com\", options, () => {\n  process.stdin.pipe(socket);\n  process.stdin.resume();\n}); // Compliant: by default rejectUnauthorized  is set to true\n")),Object(i.b)("p",null,"request module:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-javascript"},"let socket = request.get({\n    url: 'https://www.example.com/',\n    secureProtocol: 'TLSv1_2_method' // Compliant\n}); // Compliant: by default rejectUnauthorized  is set to true\n")),Object(i.b)("h2",{id:"risk-assessment"},"Risk Assessment"),Object(i.b)("p",null,"Failure frequently compromises all data that should have been protected. Typically, this information includes sensitive personal information (PII) data such as health records, credentials, personal data, and credit cards, which often require protection as defined by laws or regulations such as the EU GDPR or local privacy laws."),Object(i.b)("h2",{id:"references"},"References"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html"},"A3:2017-Sensitive Data Exposure")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html"},"A6:2017-Security Misconfiguration"))))}p.isMDXComponent=!0},136:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var r=n(0),a=n.n(r);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=a.a.createContext({}),p=function(e){var t=a.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},u=function(e){var t=p(e.components);return a.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},b=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=p(n),b=r,m=u["".concat(o,".").concat(b)]||u[b]||d[b]||i;return n?a.a.createElement(m,c(c({ref:t},l),{},{components:n})):a.a.createElement(m,c({ref:t},l))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=b;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,o[1]=c;for(var l=2;l<i;l++)o[l]=n[l];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);