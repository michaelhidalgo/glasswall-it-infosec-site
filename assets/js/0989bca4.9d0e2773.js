(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{136:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return f}));var n=r(0),a=r.n(n);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=a.a.createContext({}),u=function(e){var t=a.a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},p=function(e){var t=u(e.components);return a.a.createElement(l.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=a.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=u(r),d=n,f=p["".concat(s,".").concat(d)]||p[d]||b[d]||i;return r?a.a.createElement(f,o(o({ref:t},l),{},{components:r})):a.a.createElement(f,o({ref:t},l))}));function f(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,s=new Array(i);s[0]=d;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:n,s[1]=o;for(var l=2;l<i;l++)s[l]=r[l];return a.a.createElement.apply(null,s)}return a.a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},69:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return s})),r.d(t,"metadata",(function(){return o})),r.d(t,"toc",(function(){return c})),r.d(t,"default",(function(){return u}));var n=r(3),a=r(8),i=(r(0),r(136)),s={title:"Cross-Site Request Forgery (CSRF)",sidebar_label:"Cross-Site Request Forgery (CSRF)"},o={unversionedId:"security_awareness/languages/TypeScript/CSRF",id:"security_awareness/languages/TypeScript/CSRF",isDocsHomePage:!1,title:"Cross-Site Request Forgery (CSRF)",description:"Description",source:"@site/docs/security_awareness/languages/TypeScript/CSRF.md",slug:"/security_awareness/languages/TypeScript/CSRF",permalink:"/docs/security_awareness/languages/TypeScript/CSRF",version:"current",sidebar_label:"Cross-Site Request Forgery (CSRF)",sidebar:"someSidebar",previous:{title:"Improper Certificate Validation",permalink:"/docs/security_awareness/languages/TypeScript/ImproperCertificateValidation"},next:{title:"Cross-origin Communications Vulnerability",permalink:"/docs/security_awareness/languages/TypeScript/CrossOrigin"}},c=[{value:"Description",id:"description",children:[]},{value:"Vulnerable Code Example",id:"vulnerable-code-example",children:[]},{value:"Mitigation",id:"mitigation",children:[]},{value:"Risk Assessment",id:"risk-assessment",children:[]},{value:"References",id:"references",children:[]}],l={toc:c};function u(e){var t=e.components,r=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},l,r,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"description"},"Description"),Object(i.b)("p",null,"Cross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which they\u2019re currently authenticated. With a little help of social engineering (such as sending a link via email or chat), an attacker may trick the users of a web application into executing actions of the attacker\u2019s choosing. If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like transferring funds, changing their email address, and so forth. If the victim is an administrative account, CSRF can compromise the entire web application."),Object(i.b)("p",null,"CSRF vulnerabilities occur when attackers can trick a user to perform sensitive authenticated operations on a web application without his consent."),Object(i.b)("p",null,"Ask Yourself Whether"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"There exist sensitive operations on the web application that can be performed when the user is authenticated."),Object(i.b)("li",{parentName:"ul"},"The state / resources of the web application could be modified by doing HTTP POST or HTTP DELETE requests for example."),Object(i.b)("li",{parentName:"ul"},"The web application is not only a public API designed to be requested by external websites.")),Object(i.b)("p",null,"There is a risk if you answered yes to any of those questions."),Object(i.b)("p",null,"Recommended Secure Coding Practices"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Protection against CSRF attacks is strongly recommended:\n",Object(i.b)("strong",{parentName:"li"}," to be activated by default for all unsafe HTTP methods.\n")," implemented, for example, with an unguessable CSRF token"),Object(i.b)("li",{parentName:"ul"},"Of course all sensitive operations should not be performed with safe HTTP methods like GET which are designed to be used only for information retrieval.")),Object(i.b)("h2",{id:"vulnerable-code-example"},"Vulnerable Code Example"),Object(i.b)("p",null,"Express.js CSURF middleware protection is not found on an unsafe HTTP method like POST method:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-javascript"},"let csrf = require('csurf');\nlet express = require('express');\n\nlet csrfProtection = csrf({ cookie: true });\n\nlet app = express();\n\n// Sensitive: this operation doesn't look like protected by CSURF middleware (csrfProtection is not used)\napp.post('/money_transfer', parseForm, function (req, res) {\n  res.send('Money transferred');\n});\n")),Object(i.b)("p",null,"Protection provided by Express.js CSURF middleware is globally disabled on unsafe methods:"),Object(i.b)("h2",{id:"mitigation"},"Mitigation"),Object(i.b)("p",null,"Express.js CSURF middleware protection is used on unsafe methods:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-javascript"},"let csrf = require('csurf');\nlet express = require('express');\n\nlet csrfProtection = csrf({ cookie:  true });\n\nlet app = express();\n\napp.post('/money_transfer', parseForm, csrfProtection, function (req, res) { // Compliant\n  res.send('Money transferred')\n});\n")),Object(i.b)("p",null,"Protection provided by Express.js CSURF middleware is enabled on unsafe methods:"),Object(i.b)("h2",{id:"risk-assessment"},"Risk Assessment"),Object(i.b)("p",null,"Such flaws frequently give attackers unauthorized access to some system data or functionality. Occasionally, such flaws result in a complete system compromise. The business impact depends on the protection needs of the application and data."),Object(i.b)("h2",{id:"references"},"References"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://cwe.mitre.org/data/definitions/352.html"},"CWE-352: Cross-Site Request Forgery (CSRF)")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://owasp.org/www-community/attacks/csrf"},"Cross Site Request Forgery (CSRF)")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://www.sans.org/top25-software-errors/#cat1"},"CWE/SANS TOP 25 Most Dangerous Software Errors")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html"},"A6:2017-Security Misconfiguration"))))}u.isMDXComponent=!0}}]);